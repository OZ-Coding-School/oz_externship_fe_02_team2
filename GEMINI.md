# GEMINI.md

> Lecture Platform Admin — Gemini Code Review Guide

## 1) 프로젝트 컨텍스트

- FE Stack: Vite + React 19 + TypeScript(strict) + React Router
- UI: Tailwind CSS
- 상태: React Query(데이터) + Zustand(뷰/세션 등) 사용 가능
- 모듈: 강의/강사/수강생/스터디/과제/결제(Admin)
- 인증/권한: Role(ADMIN/TEACHER/STUDENT)
- 테이블: 공통 DataTable (정렬/검색/필터/페이지네이션/가상스크롤)

## 2) 리뷰 목표

- **정확성/안전성**: 타입/널 안전, 비동기/경계값, 예외 처리
- **권한/보안**: Role 체크, 민감정보 노출 금지, 토큰/쿠키 관리
- **데이터 계층**: React Query 키 일관성, 캐시·에러·로딩 UX
- **UI/접근성**: 테이블 시맨틱, aria-label/role, 포커스 트랩
- **성능/유지보수**: 렌더 최소화, 메모/분리, 번들 증량 방지
- **일관성**: Tailwind 유틸 순서·토큰, 코드 스타일

## 3) 공통 체크리스트

- [ ] any 지양, 정확한 타입(Generics/Discriminated Union)
- [ ] null/undefined 대비 (옵셔널 체이닝/일관된 기본값)
- [ ] API 호출: try/catch + 사용자 메시지(Toast/Alert)
- [ ] 비동기: 로딩/빈 상태/에러 상태 렌더 분기
- [ ] React Query:
  - [ ] 안정적인 `queryKey` 구성(`['lectures', filters]` 패턴)
  - [ ] `select`/`staleTime`/`gcTime` 적절
  - [ ] mutation 후 invalidate 정확(범위 축소)
- [ ] Zustand/Context: 전역 최소화, 셀렉터로 불필요 렌더 방지
- [ ] Tailwind: 인라인 `style` 지양, 테마 토큰 우선
- [ ] a11y: `<table><thead><tbody>` 구조, `<th scope="col|row">`
- [ ] Hydration: `<table>` 하위에 텍스트 노드/빈 공백 금지
- [ ] Router: 보호 라우트(ADMIN 전용), Suspense/Lazy 고려
- [ ] 보안: 쿠키/토큰 저장 위치, 민감 로그/console 금지
- [ ] 테스트/로깅: 에러 경계, 중요한 유틸에 단위 테스트

## 4) 모듈별 심화 체크

### 4.1 강의(등록/수정/상태)

- [ ] 폼 검증(Yup/Zod) 및 즉시 피드백
- [ ] 이미지/파일 업로드(확장자/용량 제한)·프리뷰·취소
- [ ] 상태 전이(초안→검수→오픈→종료) 비즈 규칙 반영
- [ ] 커리큘럼 리스트 드래그/정렬 성능·키 안정성

### 4.2 스터디/과제/채점

- [ ] 제출 마감/지각 처리 로직, 타임존 일관성
- [ ] 리스트 가상화(대량 데이터), 셀 편집 포커스 이동
- [ ] 채점/피드백 mutation의 낙관적 업데이트 사용 여부

### 4.3 회원/권한

- [ ] Role 기반 UI 비표시(숨김) + 서버 수신 시 2차 방어
- [ ] 민감정보 마스킹(email/전화 일부 비가림)
- [ ] 대량 엑셀 업/다운로드(백그라운드 처리/스피너)

### 4.4 결제/환불

- [ ] 금액/통화 포맷 로캘, 소수점 반올림 규칙
- [ ] 환불/부분환불 시 합계 재계산·경계값 테스트
- [ ] 내부/외부 결제 상태 맵핑 테이블 일관성

## 5) 테이블/필터/페이지네이션

- [ ] 서버/클라이언트 정렬 구분, 서버 정렬 시 파라미터 표준화
- [ ] "표시 개수 변경" 시 1페이지로 리셋
- [ ] 다중 필터 조합 → `queryKey`와 URL 쿼리 싱크
- [ ] 선택(checkbox) + 일괄 작업 UX(확인 다이얼로그 포함)

## 6) 성능 가이드

- [ ] 리스트 컴포넌트 메모/가상화, `key` 안정
- [ ] 불변성 유지, 무거운 파생 연산 `useMemo`
- [ ] 이미지 지연 로드, 아이콘 스프라이트/트리 셰이킹
- [ ] 번들: 동적 import, 라우트 단위 코드 스플릿

## 7) 보안/프라이버시

- [ ] 토큰은 httpOnly 쿠키(가능 시), 로컬스토리지 사용 시 위험 인지
- [ ] CORS/CSRF 정책 문서화, 민감 데이터 로깅 금지
- [ ] URL에 토큰/PII 포함 금지, 다운가능 파일 접근 제어

## 8) PR 템플릿(검수자용)

**요약**: 변경 목적/범위/영향  
**리스크**: 데이터/권한/성능 영향  
**테스트**: 시나리오/스크린샷/동영상  
**체크**:

- [ ] 타입·널 안전
- [ ] 권한 방어선
- [ ] Query 캐시/무효화
- [ ] a11y/하이드레이션
- [ ] Tailwind/DaisyUI 일관

## 9) Gemini에게 바라는 출력 형식

1. High-risk (Blocking) — 근거 포함
2. Medium/Low — 코드 위치·근거
3. Patch 제안 — 최소 diff(코드블록)
4. 회귀 테스트 아이디어
